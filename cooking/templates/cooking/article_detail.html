{% extends "base.html" %}

{% block main %}
	<div class="d-flex justify-content-between"><div class="col-8">
		<div class="card"><div class="card-header d-flex justify-content-between">{{ post.category }}
			<div>
                {% if reqest.user == post.author %}
                    <a href="{% url 'post_delete' pk=post.pk %}" class="btn btn-dark">Удалить</a>
                    <a href="{% url 'post_update' pk=post.pk %}" class="btn btn-dark">Изменить</a>
                {% endif %}
				<a href="javascript:history.back()" class="btn btn-dark">Назад</a>
			</div>
		</div>
			<img src="" class="card-img-top" alt=""><div class="card-body">
			{% if post.photo %}
			<img src="{{ post.photo.url }}" width="300" alt="">
			{% else %}
			<img src="https://frutiss.ru/image/cache/placeholder-800x800.png" width="300" alt="{{ post.title }}">
			{% endif %}
			<h5 class="card-title">{{ post.title }}</h5>
			<p class="card-text">{{ post.content | linebreaks }}</p>
		</div>
			<div class="card-footer d-flex justify-content-between"><p class="card-text">{{ post.updated_at }}</p>
				<a href="{% url 'profile' user_id=post.auhtor.id %}">Автор статьи: {{ post.author }}</a>
				<p class="card-text">{{ post.watched }}</p>
			</div>
		</div>
		<hr>

		<!--  reviews-->
        {% if request.user.is_authenticated %}
            <form action="{% url 'add_comment' post_id=post.pk %}" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                {% include "components/_form_errors.html" %}
                {{ comment_form }}
                <button class="btn btn-dark" type="submit">Добавить комментарий</button>
            </form>
        {% endif %}
    
        {% for comment in comments %}
          <div class="card mt-3">
            <div class="card-header d-flex justify-content-between align-items-center">
              <strong>{{ comment.user }}</strong>
              <small class="text-muted">{{ comment.created_at|date:"d.m.Y H:i" }}</small>
            </div>
            <div class="card-body">
              <p class="card-text mb-0">{{ comment.text }}</p>
            </div>
          </div>
        {% endfor %}
	</div>
	<!--  Recommendation-->
	<div class="col-1"></div>
	<div class="col-4">
		{% for ext in ext_posts %}
			<div class="card" style="width: 18rem;">
				{% if ext.photo %}
				<img src="{{ ext.photo.url }}" width="100%" alt="{{ ext.title }}">
				{% else %}
				<img src="https://frutiss.ru/image/cache/placeholder-800x800.png" width="100%" alt="{{ ext.title }}">
				{% endif %}
			<div class="card-body">
				<h5 class="card-title">{{ ext.title }}</h5>
				<a href="{{ ext.get_absolute_url }}" class="btn btn-primary">Подробнее</a>
			</div>
		{% endfor %}	
		</div>
	</div>
	</div>
{% endblock main %}

